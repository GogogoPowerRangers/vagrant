<?xml version="1.0" encoding="UTF-8"?>
<!-- Licensed Materials - Property of IBM 5724-V09 (C) -->
<!-- Copyright IBM Corporation 2013. All rights reserved. -->
<!-- US Government Users Restricted Rights - Use, duplication -->
<!-- or disclosure restricted by GSA ADP Schedule Contract with IBM Corp. -->
<oslc_template xmlns:tmsoslc="http://localhost.com/tmsoslc" xmlns:crtv="http://open-services.net/ns/crtv#" xmlns:im="http://tivoli-OSLC-prototypes/ns/im#">
  <!-- This section is for query assembly mapping -->
  <tmsoslc:product>KRZ</tmsoslc:product>
  <tmsoslc:when>@ checkVersionRange ${VERSION} MIN '06.31.00' *EQ 1</tmsoslc:when>
  <tmsoslc:interval minutes="30"/>
  <tmsoslc:queries>
    <tmsoslc:query name="KRZINSINFO" when="affinity=%IBM.OracleAgentRDB          00000000030000qA043" discovery="y">
      <tmsoslc:where>
				"SYSTEM.PARMA('NODELIST','${MSYSN}',32) AND ORIGINNODE = '${MSYSN}'"
			</tmsoslc:where>
      <tmsoslc:tablename name="KRZINSTINF">
        <tmsoslc:columnname>ORIGINNODE</tmsoslc:columnname>
        <tmsoslc:columnname>INSTNAME</tmsoslc:columnname>
        <tmsoslc:columnname>DBUNIQNAME</tmsoslc:columnname>
      </tmsoslc:tablename>
    </tmsoslc:query>
    <tmsoslc:query name="KRZINSINFO_METRICS" when="affinity=%IBM.OracleAgentRDB          00000000030000qA043" discovery="n">
      <tmsoslc:where>
				"SYSTEM.PARMA('NODELIST','${MSYSN}',32) AND ORIGINNODE = '${MSYSN}' AND INSTNAME='${crtv:name}'"
			</tmsoslc:where>
      <tmsoslc:tablename name="KRZINSTINF">
        <tmsoslc:columnname>ORIGINNODE</tmsoslc:columnname>
        <tmsoslc:columnname>INSTNAME</tmsoslc:columnname>
        <tmsoslc:columnname>STATUS</tmsoslc:columnname>
        <tmsoslc:columnname>DBUNIQNAME</tmsoslc:columnname>
        <tmsoslc:columnname>DBSTATUS</tmsoslc:columnname>
      </tmsoslc:tablename>
    </tmsoslc:query>
    <tmsoslc:query name="KRZBUFFERHIT" when="affinity=%IBM.OracleAgentRDB          00000000030000qA043" discovery="n">
      <tmsoslc:where>
				"SYSTEM.PARMA('NODELIST','${MSYSN}',32) AND ORIGINNODE = '${MSYSN}' AND NAME='Buffer Cache Hit Ratio' AND DBINSTNAME='${crtv:name}'"
			</tmsoslc:where>
      <tmsoslc:tablename name="KRZSMETGP">
        <tmsoslc:columnname>NAME</tmsoslc:columnname>
        <tmsoslc:columnname>CURVALUE</tmsoslc:columnname>
      </tmsoslc:tablename>
    </tmsoslc:query>
    <tmsoslc:query name="KRZLIBRARYHIT" when="affinity=%IBM.OracleAgentRDB          00000000030000qA043" discovery="n">
      <tmsoslc:where>
				"SYSTEM.PARMA('NODELIST','${MSYSN}',32) AND ORIGINNODE = '${MSYSN}' AND NAME='Library Cache Hit Ratio' AND DBINSTNAME='${crtv:name}'"
			</tmsoslc:where>
      <tmsoslc:tablename name="KRZSMETGP">
        <tmsoslc:columnname>NAME</tmsoslc:columnname>
        <tmsoslc:columnname>CURVALUE</tmsoslc:columnname>
      </tmsoslc:tablename>
    </tmsoslc:query>
    <tmsoslc:query name="KRZSGA" when="affinity=%IBM.OracleAgentRDB          00000000030000yA043" discovery="n">
      <tmsoslc:where>
				"SYSTEM.PARMA('NODELIST','${MSYSN}',32) AND ORIGINNODE = '${MSYSN}' AND DBINSTNAME='${crtv:name}'"
			</tmsoslc:where>
      <tmsoslc:tablename name="KRZSGAOVEW">
        <tmsoslc:columnname>INSTID</tmsoslc:columnname>
        <tmsoslc:columnname>TTSGAMB</tmsoslc:columnname>
        <tmsoslc:columnname>TTFSGAM</tmsoslc:columnname>
        <tmsoslc:columnname>TOTFPT</tmsoslc:columnname>
      </tmsoslc:tablename>
    </tmsoslc:query>
    <tmsoslc:query name="KRZRESPRO" when="affinity=%IBM.OracleAgentRDB          00000000030000qA043" discovery="n">
      <tmsoslc:where>
				"SYSTEM.PARMA('NODELIST','${MSYSN}',32) AND ORIGINNODE = '${MSYSN}' AND (RESNAME='processes') AND DBINSTNAME='${crtv:name}'"
			</tmsoslc:where>
      <tmsoslc:tablename name="KRZRESLIMN">
        <tmsoslc:columnname>RESNAME</tmsoslc:columnname>
        <tmsoslc:columnname>CURRATIO</tmsoslc:columnname>
      </tmsoslc:tablename>
    </tmsoslc:query>
    <tmsoslc:query name="KRZRESSES" when="affinity=%IBM.OracleAgentRDB          00000000030000qA043" discovery="n">
      <tmsoslc:where>
				"SYSTEM.PARMA('NODELIST','${MSYSN}',32) AND ORIGINNODE = '${MSYSN}' AND RESNAME='sessions' AND DBINSTNAME='${crtv:name}'"
			</tmsoslc:where>
      <tmsoslc:tablename name="KRZRESLIMN">
        <tmsoslc:columnname>RESNAME</tmsoslc:columnname>
        <tmsoslc:columnname>CURRATIO</tmsoslc:columnname>
      </tmsoslc:tablename>
    </tmsoslc:query>
    <tmsoslc:query name="KRZSESS" when="affinity=%IBM.OracleAgentRDB          00000000030000qA043" discovery="n">
      <tmsoslc:where>
				"SYSTEM.PARMA('NODELIST','${MSYSN}',32) AND ORIGINNODE = '${MSYSN}' AND DBINSTNAME='${crtv:name}'"
			</tmsoslc:where>
      <tmsoslc:tablename name="KRZSESSSMY">
        <tmsoslc:columnname>INST_ID</tmsoslc:columnname>
        <tmsoslc:columnname>TOTAL_CNT</tmsoslc:columnname>
      </tmsoslc:tablename>
    </tmsoslc:query>
    <tmsoslc:query name="KRZTABLESPACE" when="affinity=%IBM.OracleAgentRDB          00000000030000qA043" discovery="n">
      <tmsoslc:where>
				"SYSTEM.PARMA('NODELIST','${MSYSN}',32) AND ORIGINNODE = '${MSYSN}' ORDER BY PCIFMAX ASC"
			</tmsoslc:where>
      <tmsoslc:tablename name="KRZTSNLUE">
        <tmsoslc:columnname>TNAME</tmsoslc:columnname>
        <tmsoslc:columnname>PCIFMAX</tmsoslc:columnname>
      </tmsoslc:tablename>
    </tmsoslc:query>
    <tmsoslc:query name="KRZDATAFILE" when="affinity=%IBM.OracleAgentRDB          00000000030000qA043" discovery="n">
      <tmsoslc:where>
				"SYSTEM.PARMA('NODELIST','${MSYSN}',32) AND ORIGINNODE = '${MSYSN}'"
			</tmsoslc:where>
      <tmsoslc:tablename name="KRZDAFCOUT">
        <tmsoslc:columnname>DBUNIQNAME</tmsoslc:columnname>
        <tmsoslc:columnname>FREEPCT</tmsoslc:columnname>
      </tmsoslc:tablename>
    </tmsoslc:query>
  </tmsoslc:queries>
  <tmsoslc:ResourceDefinition type="SoftwareServer">
    <im:list>
      <im:name name="KRZ_software_server">
        <identity name="InstanceIdentity">
          <attributeGroup>KRZINSTINF</attributeGroup>
          <primaryKey keyNumber="1" attributeName="INSTNAME" attributeValue="${KRZINSINFO.INSTNAME}"/>
        </identity>
        <id name="crtv:manufacturer" value="Oracle"/>
        <id name="crtv:name" value="${KRZINSINFO.INSTNAME}"/>
        <id name="crtv:runsOn rdf:resource">
          <value>
            <resourceType>ComputerSystem</resourceType>
            <match from="IPADDRESSRAW" to="IPADDRESSRAW"/>
          </value>
        </id>
        <id name="rdf:type rdf:resource" value="http://open-services.net/ns/crtv#OracleInstance"/>
        <namingGroupList name="KRZ_Software_server_gl">
          <namingGroup name="KRZ_Software_server_group1">
            <namingMember>crtv:name</namingMember>
            <namingMember>crtv:runsOn</namingMember>
          </namingGroup>
        </namingGroupList>
        <metrics>KRZ_Server_Health</metrics>
      </im:name>
    </im:list>
  </tmsoslc:ResourceDefinition>
  <tmsoslc:ResourceDefinition type="Database">
    <im:list>
      <im:name name="DBINFOR">
        <id name="crtv:name" value="${KRZINSINFO.DBUNIQNAME}"/>
        <id name="crtv:dbInstance rdf:resource">
          <value>
            <resourceType>SoftwareServer</resourceType>
            <resourceName>KRZ_software_server</resourceName>
            <scope>this</scope>
          </value>
        </id>
        <namingGroupList name="KRZ_Software_server_gl">
          <namingGroup name="KRZ_Software_server_group1">
            <namingMember>crtv:name</namingMember>
            <namingMember>crtv:dbInstance</namingMember>
          </namingGroup>
        </namingGroupList>
        <metrics>KRZ_DataBase_Health</metrics>
      </im:name>
    </im:list>
  </tmsoslc:ResourceDefinition>
  <metrics class="KRZ_Server_Health">
    <record type="SoftwareServer">
      <!-- Instance status  -->
      <metric name="pm:availabilityStatus">
        <id name="pm:availabilityStatus rdf:resource" value="@ KRZ_PerfMonInstanceStatus ${KRZINSINFO_METRICS.STATUS}" displayValue="@ KRZ_PerfMonInstanceStatus ${KRZINSINFO_METRICS.STATUS} display" bundle-key="@ KRZ_PerfMonInstanceStatus ${KRZINSINFO_METRICS.STATUS} bundlekey" bundle-name="RZBundle"/>
        <pattern type="none"/>
        <widget name="text" order="1" title="Availability status" bundle-key="availability_status_title" bundle-name="RZBundle"/>
      </metric>
      <metric name="pm:availabilityStatus">
        <id name="pm:availabilityStatus rdf:resource" value="@ KRZ_InstanceStatus ${KRZINSINFO_METRICS.STATUS}" displayValue="@ KRZ_InstanceStatus ${KRZINSINFO_METRICS.STATUS} display" bundle-key="@ KRZ_InstanceStatus ${KRZINSINFO_METRICS.STATUS} bundlekey" bundle-name="RZBundle"/>
        <pattern type="none"/>
        <widget name="text" order="2" title="Instance status" bundle-key="instance_status_title" bundle-name="RZBundle"/>
      </metric>
      <!-- Buffer used -->
      <metric name="ems:observes">
        <pattern type="none"/>
        <reference type="ems:Measure" about="bufferhit" name="buffer-hit-metric"/>
        <widget name="bar" order="3" width="200px" height="325px" title="Buffer Cache Hit Ratio" bundle-key="bp_hit_ratio_title" bundle-name="RZBundle"/>
      </metric>
      <metric name="ems:observes">
        <pattern type="none"/>
        <reference type="ems:Measure" about="libraryhit" name="library-hit-metric"/>
        <widget name="bar" order="4" width="200px" height="325px" title="Library Cache Hit Ratio" bundle-key="library_hit_ratio_title" bundle-name="RZBundle"/>
      </metric>
      <!-- SGA used -->
      <metric name="ems:observes">
        <pattern type="none"/>
        <reference type="ems:Measure" about="SGAutil" name="sga-metric"/>
        <widget name="bar" order="5" width="200px" height="325px" title="Current Free SGA Utilization" bundle-key="SGA_title" bundle-name="RZBundle"/>
      </metric>
      <!-- Session information -->
      <!--metric name="ems:observes">
				<pattern type="none"/>
				<reference type="ems:Measure" about="Sessioninfo" name="session-infomation-metric"/>
				<widget name="bar" order="4" width="200px" height="325px" title="Total Session Count" bundle-key="session_information_title" bundle-name="RZBundle"/>
			</metric-->
      <metric name="ems:observes">
        <pattern type="none"/>
        <reference type="ems:Measure" about="ResourceConsumptionPro" name="resource-consumption-pro-metric"/>
        <widget name="bar" order="6" width="200px" height="325px" title="Current Processes Utilization" bundle-key="processes_resource_title" bundle-name="RZBundle"/>
      </metric>
      <metric name="ems:observes">
        <pattern type="none"/>
        <reference type="ems:Measure" about="ResourceConsumptionSes" name="resource-consumption-ses-metric"/>
        <widget name="bar" order="7" width="200px" height="325px" title="Current Sessions Utilization" bundle-key="sessions_resource_title" bundle-name="RZBundle"/>
      </metric>
    </record>
    <!-- Buffer utilization EMS Measure resource  -->
    <!--reference name="buffer-util-metric">
			<id name="dcterms:title" value="Utilization of Fast Communication Manager buffers" bundle-key="bufferutil-metric-title" bundle-name="RZBundle"/>
			<id name="ems:numericValue" datatype="http://www.w3.org/2001/XMLSchema#double" value="@ KRZ_DisplayPercentage ${KRZMETRICS.VALUE}" displayValue="@ KRZ_DisplayPercentage ${KRZMETRICS.VALUE} display" axis="x" axis-type="number" axis-range="0-100"/>
			<id name="ems:unitOfMeasure rdf:resource" value="http://dbpedia.org/resource/Percentage"/>
			<id name="ems:metric rdf:resource" value="http://open-services.net/ns/perfmon#BufferCacheHit"/>
		</reference-->
    <reference name="buffer-hit-metric">
      <id name="dcterms:title" value="Buffer Cache Hit Ratio" bundle-key="bufferhit-metric-title" bundle-name="RZBundle"/>
      <id name="ems:numericValue" datatype="http://www.w3.org/2001/XMLSchema#double" value="@ KRZ_DisplayPercentage ${KRZBUFFERHIT.CURVALUE}" displayValue="@ KRZ_DisplayPercentage ${KRZBUFFERHIT.CURVALUE} display" axis="x" axis-type="number" axis-range="0-100"/>
      <id name="ems:unitOfMeasure rdf:resource" value="http://dbpedia.org/resource/Percentage"/>
      <id name="ems:metric rdf:resource" value="http://open-services.net/ns/perfmon#BufferPoolHits"/>
    </reference>
    <reference name="library-hit-metric">
      <id name="dcterms:title" value="Library Cache Hit Ratio" bundle-key="library-metric-title" bundle-name="RZBundle"/>
      <id name="ems:numericValue" datatype="http://www.w3.org/2001/XMLSchema#double" value="@ KRZ_DisplayPercentage ${KRZLIBRARYHIT.CURVALUE}" displayValue="@ KRZ_DisplayPercentage ${KRZLIBRARYHIT.CURVALUE} display" axis="x" axis-type="number" axis-range="0-100"/>
      <id name="ems:unitOfMeasure rdf:resource" value="http://dbpedia.org/resource/Percentage"/>
      <id name="ems:metric rdf:resource" value="http://jazz.net/ns/ism/perfmon/itm#LibraryCacheHitRatio"/>
    </reference>
    <reference name="sga-metric">
      <id name="dcterms:title" value="Current Free SGA Utilization" bundle-key="SGA-title" bundle-name="RZBundle"/>
      <id name="ems:numericValue" datatype="http://www.w3.org/2001/XMLSchema#double" value="@ KRZ_DisplayPercentage ${KRZSGA.TOTFPT}" displayValue="@ KRZ_DisplayPercentage ${KRZSGA.TOTFPT} display" axis="x" axis-type="number" axis-range="0-100"/>
      <id name="ems:unitOfMeasure rdf:resource" value="http://dbpedia.org/resource/Percentage"/>
      <id name="ems:metric rdf:resource" value="http://open-services.net/ns/perfmon#HeapMemoryUsed"/>
    </reference>
    <!--reference name="session-infomation-metric">
			<id name="dcterms:title" value="Total Session Count" bundle-key="remote-conn-metric-title" bundle-name="RZBundle"/>
			<id name="ems:numericValue" datatype="http://www.w3.org/2001/XMLSchema#double" value="${KRZSESS.TOTAL_CNT}" displayValue="${KRZSESS.TOTAL_CNT}" axis="x" axis-type="number"/>
			<id name="ems:unitOfMeasure rdf:resource" value="http://dbpedia.org/resource/Count_data"/>
			<id name="ems:metric rdf:resource" value="http://open-services.net/ns/perfmon#TBD"/>
		</reference-->
    <reference name="resource-consumption-pro-metric">
      <id name="dcterms:title" value="Current Processes  Utilization " bundle-key="pro-resource-consumption-metric-title" bundle-name="RZBundle"/>
      <id name="ems:numericValue" datatype="http://www.w3.org/2001/XMLSchema#double" value="@ KRZ_DisplayPercentage ${KRZRESPRO.CURRATIO}" displayValue="@ KRZ_DisplayPercentage ${KRZRESPRO.CURRATIO} display" axis="x" axis-type="number" axis-range="0-100"/>
      <id name="ems:unitOfMeasure rdf:resource" value="http://dbpedia.org/resource/Percentage"/>
      <id name="ems:metric rdf:resource" value="http://jazz.net/ns/ism/perfmon/itm#ProcessesInUse"/>
    </reference>
    <reference name="resource-consumption-ses-metric">
      <id name="dcterms:title" value="Current Sessions Utilization" bundle-key="ses-resource-consumption-metric-title" bundle-name="RZBundle"/>
      <id name="ems:numericValue" datatype="http://www.w3.org/2001/XMLSchema#double" value="@ KRZ_DisplayPercentage ${KRZRESSES.CURRATIO}" displayValue="@ KRZ_DisplayPercentage ${KRZRESSES.CURRATIO} display" axis="x" axis-type="number" axis-range="0-100"/>
      <id name="ems:unitOfMeasure rdf:resource" value="http://dbpedia.org/resource/Percentage"/>
      <id name="ems:metric rdf:resource" value="http://http://jazz.net/ns/ism/perfmon/itm#SessionsInUse"/>
    </reference>
  </metrics>
  <metrics class="KRZ_DataBase_Health">
    <record type="Database">
      <metric name="ems:observes">
        <pattern type="none"/>
        <reference type="ems:Measure" about="Datafileusage" name="data-file-usage-metric"/>
        <widget name="bar" order="1" width="200px" height="325px" title="Data File Usage" bundle-key="data_file_title" bundle-name="RZBundle"/>
      </metric>
      <metric name="itm:topTablespaceUsage">
        <pattern type="sequence" name="toptablespace-seq" limit="5"/>
        <reference type="crtv:Tablespace" about="${KRZTABLESPACE.TNAME}" name="table-space-usage-metric"/>
        <widget name="simple-table" order="2" width="200px" height="325px" title="Tablespace Usage: Bottom 5" bundle-key="table_space_usage_title" bundle-name="RZBundle"/>
      </metric>
    </record>
    <reference name="data-file-usage-metric">
      <id name="dcterms:title" value="Total Files Free " bundle-key="total-file-metric-title" bundle-name="RZBundle"/>
      <id name="ems:numericValue" datatype="http://www.w3.org/2001/XMLSchema#double" value="@ KRZ_DisplayPercentage ${KRZDATAFILE.FREEPCT}" displayValue="@ KRZ_DisplayPercentage ${KRZDATAFILE.FREEPCT} display" axis="x" axis-type="number" axis-range="0-100"/>
      <id name="ems:unitOfMeasure rdf:resource" value="http://dbpedia.org/resource/Percentage"/>
      <id name="ems:metric rdf:resource" value="http://jazz.net/ns/ism/perfmon/itm#DataFileFreeUtil"/>
    </reference>
    <reference name="table-space-usage-metric" pmr="y">
      <sub-reference property-name="ems:observes" reference-type="ems:Measure" reference-value="${KRZTABLESPACE.TNAME}-tablespaceUtil" reference-name="FreeMaximun"/>
      <id name="crtv:name" value="${KRZTABLESPACE.TNAME}" displayValue="${KRZTABLESPACE.TNAME}" column-name="Tablespace" orderBy="2" axis="y" axis-type="string" column-bundle-key="tablespace-title" column-bundle-name="RZBundle"/>
      <id name="ems:metric rdf:resource" value="http://open-services.net/ns/perfmon#TableSpaceFree"/>
    </reference>
    <reference name="FreeMaximun">
      <id name="dcterms:title" value="Utilization" bundle-key="tablespace_util_metric" bundle-name="RZBundle"/>
      <id name="ems:numericValue" datatype="http://www.w3.org/2001/XMLSchema#double" value="@ KRZ_DisplayPercentage ${KRZTABLESPACE.PCIFMAX}" displayValue="@ KRZ_DisplayPercentage ${KRZTABLESPACE.PCIFMAX} display" orderBy="1" axis="x" axis-type="number" axis-range="0-100" column-name="Utilization" column-bundle-key="Maximum_utilization_title" column-bundle-name="RZBundle"/>
      <id name="ems:unitOfMeasure rdf:resource" value="http://dbpedia.org/resource/Percentage"/>
      <id name="ems:metric rdf:resource" value="http://open-services.net/ns/perfmon#TableSpaceFree"/>
    </reference>
  </metrics>
  <method library="krzutil.lib" name="KRZ_PerfMonInstanceStatus"/>
  <method library="krzutil.lib" name="KRZ_DisplayPercentage"/>
  <method library="krzutil.lib" name="KRZ_InstanceStatus"/>
</oslc_template>
