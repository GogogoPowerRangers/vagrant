//---------------------------------------------------------------------------------
// ****                                                                        ****
// ****	Licensed Materials - Property of IBM 5724-V09 (C) ****
// ****	Copyright IBM Corporation 2013. All rights reserved. ****
// ****	US Government Users Restricted Rights - Use, duplication ****
// ****	or disclosure restricted by GSA ADP Schedule Contract with IBM Corp. ****
// ****                                                                        ****
// ****                                                                        ****
//---------------------------------------------------------------------------------

set copyright = "Licensed Materials - Property of IBM 5724-V09 (C) Copyright IBM Corporation 2013. All rights reserved. US Government Users Restricted Rights - Use, duplication or disclosure restricted by GSA ADP Schedule Contract with IBM Corp.";

// Module:  kudutil.lib
//
// Purpose: KUD Agent specific utilities for discovery and metric conversion
//
//---------------------------------------------------------------------------------


Function KUD_DisplayPercentage value input parm
{
    value = input;
	
	if (input == "")
	{
		value = 0;
	}
	else if (input == "-1")
	{
		value = 0;
	}
    
    if (parm == "display")
    {
        value = value "%";
    }

    if (properties.print == "y")
    {
        retcode = rasprint("KUD_DisplayPercentage: Using input %s. Value is %s",
                           input,value);
    }
       
    return;
}

Function KUD_InstanceStatus value input parm
{ 	
	set notRunStatus = "http://open-services.net/ns/perfmon#NotRunning";
	set runStatus = "http://open-services.net/ns/perfmon#Running";
	set unknownStatus = "http://open-services.net/ns/perfmon#Unknown";
	
	value = unknownStatus;
    
	// for some reason using logical equals is causing compile errors
	
	if (strcontains(input, "Active") == 1 )
	{
		value = runStatus;
	}
	else if (strcontains(input, "Inactive/Busy") == 1 )
	{
		value = unknownStatus;
	}
	else if (strcontains(input, "Quiesce_Pending") == 1 )
	{
		value = notRunStatus;
	}
	else if (strcontains(input, "Quiesced") == 1 )
	{
		value = notRunStatus;
	}
	else if (strcontains(input, "Unknown") == 1 )
	{
		value = unknownStatus;
	}
	else 
	{
		value = unknownStatus;
	}
	
	
	if (parm == "display")
    {
        if (value == notRunStatus)
		{
			value = "Not running";
		}
		else if (value == runStatus)
		{
			value = "Running";
		}
		else
		{
			value = "Unknown";
		}		
    }
	
	if (parm == "bundlekey")
    {
        if (value == notRunStatus)
		{
			value = "notrunning_key";
		}
		else if (value == runStatus)
		{
			value = "running_key";
		}
		else
		{
			value = "unknown_key";
		}		
    }
    
    if (properties.print == "y")
    {
        retcode = rasprint("KUD_InstanceStatus: Using input %s. Value is %s",
                           input,value);
    }
       
    return;
}




